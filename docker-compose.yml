version: '3'
services:
    web:
        build:
            context: .
            dockerfile: Dockerfile
        command: >
            bash -c "python manage.py makemigrations &&
                    python manage.py migrate &&
                    gunicorn -b 0:4000 -w 2 isaac_project.wsgi:application"

        volumes:
            - .:/isaac
        expose:
            - "4000"
    nginx:
        image: nginx:latest
        ports:
            - "80:80"
        volumes:
            - .:/isaac
            - ./config/nginx/:/etc/nginx/conf.d/
        depends_on:
            - web
